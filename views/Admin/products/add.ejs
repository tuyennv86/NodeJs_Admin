<!DOCTYPE html>
<html>

<head>
    <% include ../../partials/backend/partialLink %>
        <% include ../../partials/backend/partialCsript %>
            <link rel="stylesheet" href="/jodit-3.3.8/jodit.min.css" />
            <script src="/jodit-3.3.8/jodit.min.js"></script>
            <!-- <script type="text/javascript" src="/ckeditor/ckeditor.js"></script> -->
</head>

<body>
    <% include ../../partials/backend/aside %>
        <div id="right-panel" class="right-panel">
            <% include ../../partials/backend/header %>

                <div class="breadcrumbs">
                    <div class="col-sm-4">
                        <div class="page-header float-left">
                            <div class="page-title">
                                <h1>Thêm mới sản phẩm</h1>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-8">
                        <div class="page-header float-right">
                            <div class="page-title">
                                <ol class="breadcrumb text-right">
                                    <li><a href="index">Trang chủ</a></li>
                                    <li class="active">Thêm mới sản phẩm</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content mt-3">
                    <div class="animated fadeIn">
                        <div class="card">
                            <div class="card-header">
                                <strong>Thêm mới sản phẩm</strong>
                            </div>
                            <div class="card-body card-block">
                                <% include ../../partials/backend/messages %>
                                    <form action="/admin/product/add" method="post" enctype="multipart/form-data"
                                        class="form-horizontal form-validate" id="ud">

                                        <div class="row form-group">
                                            <div class="col col-md-3"><label for="parent"
                                                    class="form-control-label">Danh mục sản phẩm :</label></div>
                                            <div class="col-12 col-md-9 mserro">
                                                <select name="slCategory" id="slCategory" class="form-control"
                                                    data-placeholder="Chọn mục cha..." data-rule-required="true">
                                                    <%- include('../../partials/backend/dropallTree', {items: catedata,
                                                        level: 1, id_check: 1 }) %>
                                                        <select>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class="form-control-label">Tên sản phẩm
                                                    :</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="productName"
                                                    name="productName" placeholder="Nhập tên sản phẩm"
                                                    class="form-control" data-rule-required="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Tên
                                                    Alias:</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="productKey"
                                                    name="productKey" placeholder="Nhập tên Alias" class="form-control"
                                                    data-rule-required="true"><span id="keyspan"
                                                    style="color:red;"><span></div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Meta
                                                    Tile:</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="metaTile"
                                                    name="metaTile" placeholder="Nhập tên hiển thị cho Title"
                                                    class="form-control" data-rule-required="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Meta
                                                    Keyword:</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="metaKeyword"
                                                    name="metaKeyword" placeholder="Nhập keyword" class="form-control"
                                                    data-rule-required="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Meta
                                                    Description:</label></div>
                                            <div class="col-12 col-md-9 mserro"><textarea id="metaDescription"
                                                    name="metaDescription" placeholder="Nhập Description"
                                                    class="form-control" data-rule-required="true" rows="2"></textarea>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class="form-control-label">Mã sản phẩm
                                                    :</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="productCode"
                                                    name="productCode" placeholder="Nhập mã sản phẩm"
                                                    class="form-control" data-rule-required="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Số
                                                    lượng:</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="quantum"
                                                    name="quantum" placeholder="Nhập số sản phẩm" class="form-control"
                                                    data-rule-required="true" data-rule-number="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Thứ tự</label>
                                            </div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="order"
                                                    name="order" placeholder="Nhập thứ tự sản phẩm" class="form-control"
                                                    data-rule-required="true" data-rule-number="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Giá bán</label>
                                            </div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="price"
                                                    name="price" placeholder="Nhập giá bán sau khi giảm"
                                                    class="form-control" data-rule-required="true"
                                                    data-rule-number="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Giá cũ</label>
                                            </div>
                                            <div class="col-12 col-md-9 mserro"><input type="text" id="priceOld"
                                                    name="priceOld" placeholder="Nhập giá cũ trước khi giảm"
                                                    class="form-control" data-rule-required="true"
                                                    data-rule-number="true"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label for="fileImg"
                                                    class=" form-control-label">Chọn ảnh</label></div>
                                            <div class="col-12 col-md-9 mserro"><input type="file" id="fileImg"
                                                    name="fileImg" class="form-control-file" accept="image/*"></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label for="fileImg"
                                                    class=" form-control-label">Ảnh khác</label></div>
                                            <div class="col-12 col-md-9 mserro">
                                                <input type="file" id="fileimageRelated" name="fileimageRelated"
                                                    class="form-control-file" accept="image/*" multiple>
                                            </div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Mô tả
                                                    ngắn:</label></div>
                                            <div class="col-12 col-md-9 mserro"><textarea id="preview" name="preview"
                                                    placeholder="Nhập mô tả ngắn" class="form-control" rows="3"
                                                    cols="50"></textarea></div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3"><label class=" form-control-label">Chi
                                                    tiết:</label></div>
                                            <div class="col-12 col-md-9 mserro"><textarea id="detail" name="detail"
                                                    placeholder="Nhập chi tiết" class="form-control" rows="4"
                                                    cols="50"></textarea></div>
                                        </div>

                                        <div class="row form-group">
                                            <div class="col col-md-3"> &nbsp; </div>
                                            <div class="col col-md-9">
                                                <div class="form-check">
                                                    <div class="checkbox">
                                                        <label for="chkActive" class="form-check-label ">
                                                            <input type="checkbox" id="chkActive" name="chkActive"
                                                                class="form-check-input"> Active
                                                        </label>
                                                    </div>
                                                    <div class="checkbox">
                                                        <label for="chkHome" class="form-check-label ">
                                                            <input type="checkbox" id="chkHome" name="chkHome"
                                                                class="form-check-input"> home
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row form-group">
                                            <div class="col col-md-3">&nbsp;</div>
                                            <div class="col-12 col-md-9"><button type="submit" id="bntAdd"
                                                    class="btn btn-primary btn-sm"><i class="fa fa-plus-square-o"></i>
                                                    Thêm mới</button>
                                                <a href="/admin/product/Index" class="btn btn-danger btn-sm"><i
                                                        class="fa fa-reply"></i> Quay lại</a>
                                            </div>
                                        </div>

                                    </form>
                            </div>
                        </div>
                    </div>
                </div>

        </div>

        <script>
            var editor = new Jodit('#detail', {
                textIcons: false,
                iframe: false,
                iframeStyle: '*,.jodit_wysiwyg {color:red;}',
                height: 500,
                defaultMode: Jodit.MODE_WYSIWYG,
                observer: {
                    timeout: 100
                },
                uploader: {
                    insertImageAsBase64URI: true,
                },

                // uploader: {
                //     // url: 'https://xdsoft.net/jodit/connector/index.php?action=fileUpload'
                //     url: '/api/fileView/uploads'
                // },
                // filebrowser: {
                //     // buttons: ['list', 'tiles', 'sort'],
                //     ajax: {
                //         //url: 'https://xdsoft.net/jodit/connector/index.php'
                //         url: '/api/fileView/files'
                //     }
                // },
                commandToHotkeys: {
                    'openreplacedialog': 'ctrl+p'
                }
                // buttons: ['symbol'],
                // disablePlugins: 'hotkeys,mobile'
            });
            var editor = new Jodit('#preview', {
                textIcons: false,
                iframe: false,
                iframeStyle: '*,.jodit_wysiwyg {color:red;}',
                height: 300,
                defaultMode: Jodit.MODE_WYSIWYG,
                observer: {
                    timeout: 100
                },
                uploader: {
                    insertImageAsBase64URI: true,
                },

                // uploader: {
                //     // url: 'https://xdsoft.net/jodit/connector/index.php?action=fileUpload'
                //     url: 'http://localhost:9000/api/uploads'
                // },
                // filebrowser: {
                //     // buttons: ['list', 'tiles', 'sort'],
                //     ajax: {
                //         //url: 'https://xdsoft.net/jodit/connector/index.php'
                //         url: 'http://localhost:9000/api/files'
                //     }
                // },
                commandToHotkeys: {
                    'openreplacedialog': 'ctrl+p'
                }
                // buttons: ['symbol'],
                // disablePlugins: 'hotkeys,mobile'
            });
        </script>


        <script type="text/javascript">

            jQuery(document).ready(function ($)
            {

                $('#slCategory').select2();

                $("#productName").bind("keyup", function (e)
                {
                    var productName = $(this).val();
                    $('#productKey').val(getSeoTitle(productName));
                    $('#metaTile').val(productName);
                });

                $("#productName").blur(function ()
                {
                    var catetext = $(this).val();
                    $('#productKey').val(getSeoTitle(catetext));
                    $('#metaTile').val(catetext);
                });

                function checkExistProductKey(objId)
                {
                    $("#" + objId).blur(function ()
                    {
                        $.ajax({
                            type: "GET",
                            async: true,
                            url: "/api/product/checkExistProductKey/" + $("#productKey").val(),
                            cache: false,
                            dataType: "json",
                            success: function (done)
                            {
                                if (done.status)
                                {
                                    $("#keyspan").html(done.message);
                                    $("#productKey").focus();
                                    $("#bntAdd").attr("disabled", true);
                                    return false;
                                } else
                                {
                                    $("#keyspan").html('');
                                    $("#bntAdd").removeAttr("disabled");
                                }
                            }
                        });
                    });
                }
                checkExistProductKey("productName");
                checkExistProductKey("productKey");


            });
        </script>


</body>

</html>